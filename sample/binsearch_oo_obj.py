from z3 import *
from pyeb.lib.utils import *
from pyeb.lib.assignment import *
from pyeb.lib.event import *
from pyeb.lib.context import *
from pyeb.lib.machine import *
obj0=BContext()
obj0_f=Function('obj0_f',IntSort(),IntSort())
obj0.add_constant('obj0_f',obj0_f)
obj0_n=Const('obj0_n',IntSort())
obj0.add_constant('obj0_n',obj0_n)
obj0_v=Const('obj0_v',IntSort())
obj0.add_constant('obj0_v',obj0_v)
obj0_axiom_axm0=(obj0_n>=0)
obj0.add_axiom('obj0_axiom_axm0',obj0_axiom_axm0)
obj0_axiom_axm1_x=Int('x')
obj0_axiom_axm1=(ForAll(obj0_axiom_axm1_x,Implies(And(obj0_axiom_axm1_x>=1,obj0_axiom_axm1_x<=obj0_n),obj0_f(obj0_axiom_axm1_x)>=0)))
obj0.add_axiom('obj0_axiom_axm1',obj0_axiom_axm1)
obj0_axiom_axm2_i=Int('i')
obj0_axiom_axm2_j=Int('j')
obj0_axiom_axm2=ForAll([obj0_axiom_axm2_i,obj0_axiom_axm2_j],Implies(And(obj0_axiom_axm2_i>=1,obj0_axiom_axm2_i<=obj0_n,obj0_axiom_axm2_j>=1,obj0_axiom_axm2_j<=obj0_n,obj0_axiom_axm2_i<=obj0_axiom_axm2_j),obj0_f(obj0_axiom_axm2_i)<=obj0_f(obj0_axiom_axm2_j)))
obj0.add_axiom('obj0_axiom_axm2',obj0_axiom_axm2)
obj0_axiom_axm3_x=Int('x')
obj0_axiom_axm3=Exists(obj0_axiom_axm3_x,And(And(obj0_axiom_axm3_x>=1,obj0_axiom_axm3_x<=obj0_n),obj0_f(obj0_axiom_axm3_x)==obj0_v))
obj0.add_axiom('obj0_axiom_axm3',obj0_axiom_axm3)
obj0_theorem_thm1=(obj0_n>0)
obj0.add_theorem('obj0_theorem_thm1',obj0_theorem_thm1)
obj1=BMachine(obj0)
obj1_r=Int('obj1_r')
obj1.add_variable(obj1_r)
obj1_context=obj0
obj1.add_context(obj0)
obj1_event_initialisation_guard={}
obj1_event_initialisation_init=BAssignment({obj1_r},prime(obj1_r)>=0)
obj1_event_initialisation=BEvent('initialisation',Status.Ordinary,[],obj1_event_initialisation_guard,obj1_event_initialisation_init)
obj1.add_initevt(obj1_event_initialisation)
obj1_event_progress_guard={}
obj1_event_progress_ba=BAssignment({obj1_r},prime(obj1_r)>=0)
obj1_event_progress=BEvent('progress',Status.Anticipated,[],obj1_event_progress_guard,obj1_event_progress_ba)
obj1.add_event(obj1_event_progress)
obj1_event_final_guard={'grd1_m0':And(obj1_r>=1,obj1_r<=obj0_n),'grd2_m0':(obj0_f(obj1_r)==obj0_v)}
obj1_event_final_ba=skip({obj1_r})
obj1_event_final=BEvent('final',Status.Ordinary,[],obj1_event_final_guard,obj1_event_final_ba)
obj1.add_event(obj1_event_final)
obj1_invariant_inv1=(obj1_r>=0)
obj1.add_invariant('obj1_invariant_inv1',obj1_invariant_inv1)
obj2=BMachineRefines(obj1,obj0)
obj2_r=obj1_r
obj2_context=obj1_context
obj2_context=obj0
obj2.add_context(obj0)
obj2_abstract_machine=obj1
obj2.add_variable(obj2_abstract_machine)
obj2_p=Int('obj2_p')
obj2.add_variable(obj2_p)
obj2_q=Int('obj2_q')
obj2.add_variable(obj2_q)
obj2_variant=(obj2_q-obj2_p)
obj2.add_variant((obj2_q-obj2_p))
obj2_ref_event_initialisation_guard={}
obj2_ref_event_initialisation_ba=BAssignment({obj2_p,obj2_q,obj2_r},And(prime(obj2_p)==1,prime(obj2_q)==obj0_n,prime(obj2_r)>=1,prime(obj2_r)<=obj0_n))
obj2_ref_event_initialisation_init=BEventRef('initialisation',obj1_event_initialisation)
obj2_ref_event_initialisation_init.set_status(Status.Ordinary)
obj2_ref_event_initialisation_init.add_guards(obj2_ref_event_initialisation_guard)
obj2_ref_event_initialisation_init.add_bassg(obj2_ref_event_initialisation_ba)
obj2_ref_event_initialisation=obj2_ref_event_initialisation_init
obj2.add_ref_initevt(obj2_ref_event_initialisation)
obj2_ref_event_final_guard={'grd':(obj0_f(obj2_r)==obj0_v)}
obj2_ref_event_final_ba=skip({obj2_p,obj2_q})
obj2_ref_event_final_final=BEventRef('final',obj1_event_final)
obj2_ref_event_final_final.set_status(Status.Ordinary)
obj2_ref_event_final_final.add_guards(obj2_ref_event_final_guard)
obj2_ref_event_final_final.add_bassg(obj2_ref_event_final_ba)
obj2_ref_event_final=obj2_ref_event_final_final
obj2.add_ref_event(obj2_ref_event_final)
obj2_ref_event_inc_guard={'grd1':(obj0_f(obj2_r)<obj0_v)}
obj2_ref_event_inc_ba=BAssignment({obj2_p,obj2_q,obj2_r},And(prime(obj2_p)==obj2_r+1,prime(obj2_r)>=(obj2_r+1),prime(obj2_r)<=obj2_q,prime(obj2_q)==obj2_q))
obj2_ref_event_inc_inc=BEventRef('inc',obj1_event_progress)
obj2_ref_event_inc_inc.set_status(Status.Convergent)
obj2_ref_event_inc_inc.add_guards(obj2_ref_event_inc_guard)
obj2_ref_event_inc_inc.add_bassg(obj2_ref_event_inc_ba)
obj2_ref_event_inc=obj2_ref_event_inc_inc
obj2.add_ref_event(obj2_ref_event_inc)
obj2_ref_event_dec_guard={'grd1':(obj0_f(obj2_r)>obj0_v)}
obj2_ref_event_dec_ba=BAssignment({obj2_p,obj2_q,obj2_r},And(prime(obj2_q)==obj2_r-1,prime(obj2_r)>=obj2_p,prime(obj2_r)<=obj2_r-1,prime(obj2_p)==obj2_p))
obj2_ref_event_dec_dec=BEventRef('dec',obj1_event_progress)
obj2_ref_event_dec_dec.set_status(Status.Convergent)
obj2_ref_event_dec_dec.add_guards(obj2_ref_event_dec_guard)
obj2_ref_event_dec_dec.add_bassg(obj2_ref_event_dec_ba)
obj2_ref_event_dec=obj2_ref_event_dec_dec
obj2.add_ref_event(obj2_ref_event_dec)
obj2_invariant_inv1=And(obj2_p>=1,obj2_p<=obj0_n)
obj2.add_invariant('obj2_invariant_inv1',obj2_invariant_inv1)
obj2_invariant_inv2=And(obj2_q>=1,obj2_q<=obj0_n)
obj2.add_invariant('obj2_invariant_inv2',obj2_invariant_inv2)
obj2_invariant_inv3=And(obj2_r>=obj2_p,obj2_r<=obj2_q)
obj2.add_invariant('obj2_invariant_inv3',obj2_invariant_inv3)
obj2_invariant_inv4_x=Int('x')
obj2_invariant_inv4=Exists(obj2_invariant_inv4_x,And(obj2_invariant_inv4_x>=obj2_p,obj2_invariant_inv4_x<=obj2_q,obj0_f(obj2_invariant_inv4_x)==obj0_v))
obj2.add_invariant('obj2_invariant_inv4',obj2_invariant_inv4)
obj3=BMachineRefines(obj2,obj0)
obj2_r=obj1_r
obj2_context=obj1_context
obj3_r=obj2_r
obj3_context=obj2_context
obj3_abstract_machine=obj2_abstract_machine
obj3_p=obj2_p
obj3_q=obj2_q
obj3_variant=obj2_variant
obj3_context=obj0
obj3.add_context(obj0)
obj3_abstract_machine=obj2
obj3.add_variable(obj3_abstract_machine)
obj3_ref_event_initialisation_guard={}
obj3_ref_event_initialisation_ba=BAssignment({obj3_p,obj3_q,obj3_r},And(prime(obj3_p)==1,prime(obj3_q)==obj0_n,prime(obj3_r)==((obj0_n+1)/2)))
obj3_ref_event_initialisation_init=BEventRef('initialisation',obj2_ref_event_initialisation)
obj3_ref_event_initialisation_init.set_status(Status.Ordinary)
obj3_ref_event_initialisation_init.add_guards(obj3_ref_event_initialisation_guard)
obj3_ref_event_initialisation_init.add_bassg(obj3_ref_event_initialisation_ba)
obj3_ref_event_initialisation=obj3_ref_event_initialisation_init
obj3.add_ref_initevt(obj3_ref_event_initialisation)
obj3_ref_event_final_guard={'grd1':(obj0_f(obj3_r)==obj0_v)}
obj3_ref_event_final_ba=skip({obj3_p,obj3_q,obj3_r})
obj3_ref_event_final_final=BEventRef('final',obj2_ref_event_final)
obj3_ref_event_final_final.set_status(Status.Ordinary)
obj3_ref_event_final_final.add_guards(obj3_ref_event_final_guard)
obj3_ref_event_final_final.add_bassg(obj3_ref_event_final_ba)
obj3_ref_event_final=obj3_ref_event_final_final
obj3.add_ref_event(obj3_ref_event_final)
obj3_ref_event_inc_guard={'grd1':(obj0_f(obj3_r)<obj0_v)}
obj3_ref_event_inc_ba=BAssignment({obj3_p,obj3_q,obj3_r},And(prime(obj3_p)==obj3_r+1,prime(obj3_r)==((obj3_r+1+obj3_q)/2),prime(obj3_q)==obj3_q))
obj3_ref_event_inc_inc=BEventRef('inc',obj2_ref_event_inc)
obj3_ref_event_inc_inc.set_status(Status.Ordinary)
obj3_ref_event_inc_inc.add_guards(obj3_ref_event_inc_guard)
obj3_ref_event_inc_inc.add_bassg(obj3_ref_event_inc_ba)
obj3_ref_event_inc=obj3_ref_event_inc_inc
obj3.add_ref_event(obj3_ref_event_inc)
obj3_ref_event_dec_guard={'grd1':(obj0_f(obj3_r)>obj0_v)}
obj3_ref_event_dec_ba=BAssignment({obj3_p,obj3_q,obj3_r},And(prime(obj3_q)==obj3_r-1,prime(obj3_r)==((obj3_p+obj3_r-1)/2),prime(obj3_p)==obj3_p))
obj3_ref_event_dec_dec=BEventRef('dec',obj2_ref_event_dec)
obj3_ref_event_dec_dec.set_status(Status.Ordinary)
obj3_ref_event_dec_dec.add_guards(obj3_ref_event_dec_guard)
obj3_ref_event_dec_dec.add_bassg(obj3_ref_event_dec_ba)
obj3_ref_event_dec=obj3_ref_event_dec_dec
obj3.add_ref_event(obj3_ref_event_dec)
__machine__ = obj3