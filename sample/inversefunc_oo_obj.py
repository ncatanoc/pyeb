from z3 import *
from pyeb.lib.utils import *
from pyeb.lib.assignment import *
from pyeb.lib.event import *
from pyeb.lib.context import *
from pyeb.lib.machine import *
obj0=BContext()
obj0_f=Function('obj0_f',IntSort(),IntSort())
obj0.add_constant('obj0_f',obj0_f)
obj0_n=Const('obj0_n',IntSort())
obj0.add_constant('obj0_n',obj0_n)
obj0_a=Int('obj0_a')
obj0.add_constant('obj0_a',obj0_a)
obj0_b=Int('obj0_b')
obj0.add_constant('obj0_b',obj0_b)
obj0_axiom_axm1=(obj0_n>=0)
obj0.add_axiom('obj0_axiom_axm1',obj0_axiom_axm1)
obj0_axiom_axm2_x=Int('x')
obj0_axiom_axm2=ForAll(obj0_axiom_axm2_x,Implies(And(obj0_axiom_axm2_x>=1,obj0_axiom_axm2_x<=obj0_n),obj0_f(obj0_axiom_axm2_x)>=0))
obj0.add_axiom('obj0_axiom_axm2',obj0_axiom_axm2)
obj0_axiom_axm3_i=Int('i')
obj0_axiom_axm3_j=Int('j')
obj0_axiom_axm3=ForAll([obj0_axiom_axm3_i,obj0_axiom_axm3_j],Implies(And(obj0_axiom_axm3_i>=1,obj0_axiom_axm3_i<=obj0_n,obj0_axiom_axm3_j>=1,obj0_axiom_axm3_j<=obj0_n,obj0_axiom_axm3_i<obj0_axiom_axm3_j),obj0_f(obj0_axiom_axm3_i)<obj0_f(obj0_axiom_axm3_j)))
obj0.add_axiom('obj0_axiom_axm3',obj0_axiom_axm3)
obj0_axiom_axm4=(obj0_a>=0)
obj0.add_axiom('obj0_axiom_axm4',obj0_axiom_axm4)
obj0_axiom_axm5=(obj0_b>=0)
obj0.add_axiom('obj0_axiom_axm5',obj0_axiom_axm5)
obj0_axiom_axm6=(obj0_f(obj0_a)<=obj0_n)
obj0.add_axiom('obj0_axiom_axm6',obj0_axiom_axm6)
obj0_axiom_axm7=(obj0_n<obj0_f(obj0_b+1))
obj0.add_axiom('obj0_axiom_axm7',obj0_axiom_axm7)
obj0_axiom_axm8=(obj0_a<obj0_b)
obj0.add_axiom('obj0_axiom_axm8',obj0_axiom_axm8)
obj1=BMachine(obj0)
obj1_r=Int('obj1_r')
obj1.add_variable(obj1_r)
obj1_context=obj0
obj1.add_context(obj0)
obj1_event_initialisation_guard={}
obj1_event_initialisation_init=BAssignment({obj1_r},prime(obj1_r)>=0)
obj1_event_initialisation=BEvent('initialisation',Status.Ordinary,[],obj1_event_initialisation_guard,obj1_event_initialisation_init)
obj1.add_initevt(obj1_event_initialisation)
obj1_event_final_guard={'grd1':And(obj0_f(obj1_r)<=obj0_n,obj0_n<obj0_f(obj1_r+1))}
obj1_event_final_ba=skip({obj1_r})
obj1_event_final=BEvent('final',Status.Ordinary,[],obj1_event_final_guard,obj1_event_final_ba)
obj1.add_event(obj1_event_final)
obj1_event_progress_guard={}
obj1_event_progress_ba=BAssignment({obj1_r},prime(obj1_r)>=0)
obj1_event_progress=BEvent('progress',Status.Anticipated,[],obj1_event_progress_guard,obj1_event_progress_ba)
obj1.add_event(obj1_event_progress)
obj1_invariant_inv1=(obj1_r>=0)
obj1.add_invariant('obj1_invariant_inv1',obj1_invariant_inv1)
obj2=BMachineRefines(obj1,obj0)
obj2_r=obj1_r
obj2_context=obj1_context
obj2_context=obj0
obj2.add_context(obj0)
obj2_abstract_machine=obj1
obj2.add_variable(obj2_abstract_machine)
obj2_q=Int('obj2_q')
obj2.add_variable(obj2_q)
obj2_variant=(obj2_q-obj2_r)
obj2.add_variant((obj2_q-obj2_r))
obj2_ref_event_initialisation_guard={}
obj2_ref_event_initialisation_ba=BAssignment({obj2_q,obj2_r},And(prime(obj2_r)==obj0_a,prime(obj2_q)==obj0_b))
obj2_ref_event_initialisation_init=BEventRef('initialisation',obj1_event_initialisation)
obj2_ref_event_initialisation_init.set_status(Status.Ordinary)
obj2_ref_event_initialisation_init.add_guards(obj2_ref_event_initialisation_guard)
obj2_ref_event_initialisation_init.add_bassg(obj2_ref_event_initialisation_ba)
obj2_ref_event_initialisation=obj2_ref_event_initialisation_init
obj2.add_ref_initevt(obj2_ref_event_initialisation)
obj2_ref_event_final_guard={'grd1':(obj2_r==obj2_q)}
obj2_ref_event_final_ba=skip({obj2_r,obj2_q})
obj2_ref_event_final_final=BEventRef('final',obj1_event_final)
obj2_ref_event_final_final.set_status(Status.Ordinary)
obj2_ref_event_final_final.add_guards(obj2_ref_event_final_guard)
obj2_ref_event_final_final.add_bassg(obj2_ref_event_final_ba)
obj2_ref_event_final=obj2_ref_event_final_final
obj2.add_ref_event(obj2_ref_event_final)
obj2_ref_event_inc_x=Int('x')
obj2_ref_event_inc_guard={'grd1':(obj2_ref_event_inc_x>=0),'grd2':(obj2_r!=obj2_q),'grd3':(obj2_ref_event_inc_x>=(obj2_r+1)),'grd4':(obj2_ref_event_inc_x<=obj2_q),'grd5':(obj0_f(obj2_ref_event_inc_x)<=obj0_n)}
obj2_ref_event_inc_ba=BAssignment({obj2_q,obj2_r},And(prime(obj2_r)==obj2_ref_event_inc_x,prime(obj2_q)==obj2_q))
obj2_ref_event_inc_inc=BEventRef('inc',obj1_event_progress)
obj2_ref_event_inc_inc.set_status(Status.Convergent)
obj2_ref_event_inc_inc.add_guards(obj2_ref_event_inc_guard)
obj2_ref_event_inc_inc.add_bassg(obj2_ref_event_inc_ba)
obj2_ref_event_inc=obj2_ref_event_inc_inc
obj2.add_ref_event(obj2_ref_event_inc)
obj2_ref_event_dec_x=Int('x')
obj2_ref_event_dec_guard={'grd1':(obj2_ref_event_dec_x>=0),'grd2':(obj2_ref_event_dec_x>=(obj2_r+1)),'grd3':(obj2_ref_event_dec_x<=obj2_q),'grd4':(obj2_r!=obj2_q),'grd5':(obj0_n<obj0_f(obj2_ref_event_dec_x))}
obj2_ref_event_dec_ba=BAssignment({obj2_q,obj2_r},And(prime(obj2_q)==obj2_ref_event_dec_x-1,prime(obj2_r)==obj2_r))
obj2_ref_event_dec_dec=BEventRef('dec',obj1_event_progress)
obj2_ref_event_dec_dec.set_status(Status.Convergent)
obj2_ref_event_dec_dec.add_guards(obj2_ref_event_dec_guard)
obj2_ref_event_dec_dec.add_bassg(obj2_ref_event_dec_ba)
obj2_ref_event_dec=obj2_ref_event_dec_dec
obj2.add_ref_event(obj2_ref_event_dec)
obj2_invariant_inv1=(obj2_q>=0)
obj2.add_invariant('obj2_invariant_inv1',obj2_invariant_inv1)
obj2_invariant_inv2=(obj2_r<=obj2_q)
obj2.add_invariant('obj2_invariant_inv2',obj2_invariant_inv2)
obj2_invariant_inv3=(obj0_f(obj2_r)<=obj0_n)
obj2.add_invariant('obj2_invariant_inv3',obj2_invariant_inv3)
obj2_invariant_inv4=(obj0_n<obj0_f(obj2_q+1))
obj2.add_invariant('obj2_invariant_inv4',obj2_invariant_inv4)
__machine__ = obj2